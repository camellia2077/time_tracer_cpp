## 0.3.25.1 - 2025-11-13
1.  **创建核心库 (`libreports_shared.dll`)**:
    * 将所有模块（`md`, `tex`, `typ`）都依赖的**共享代码**（例如 `DayBaseConfig`、`MonthBaseConfig`、`PeriodBaseConfig`、以及所有的 `Utils` 函数）集中起来。
    * 在 `SourceFileCollection.cmake` 中，将 `reports_shared` 库的类型从 `STATIC` 修改为 `SHARED`。
    * 使用 `REPORTS_SHARED_API` 宏（`__declspec(dllexport)`） 将这些共享类和函数的接口从 `libreports_shared.dll` 中**导出**，使其成为一个可被其他模块依赖的“核心SDK”。

2.  **格式化插件 (如 `libDayMdFormatter.dll`) 采用动态链接**:
    * 格式化插件（如 `libDayMdFormatter.dll`）现在只包含它们自己的特定实现逻辑（例如 `DayMd.cpp` 和 `MarkdownStrategy.hpp`）。
    * 在它们的 `CMakeLists.txt` 中，`target_link_libraries(... reports_shared)` 命令现在会将这个插件**动态链接**到 `libreports_shared.dll`。这使得插件可以使用 `DayBaseConfig` 等共享功能，而无需将代码复制到自己内部。
    * 主程序 `time_tracker_cli.exe` 则通过 `DllFormatterWrapper` 来**动态加载**（使用 `LoadLibraryA`）这些轻量级的插件DLL，实现了最终的插件化。

## 0.3.25.2 - 2025-12-19
1. **libreports_shared.dll放到exe同级别目录**
libreports_shared.dll是程序运行必不可少的一部分，不应该放入plugins文件夹里面

2. **支持日报告在json中自定义statistics_items**
在日报告json中自定义statistics_items,而不是硬编码在cpp里面
{
            "label": "Sleep Time",
            "db_column": "sleep_total_time",
            "show": true
},


## 0.3.25.3 - 2025-12-21

### 1. 更新摘要 (Overview)

1. **给日、月、周期的所有格式的具体活动内容加上标题**
2. **`ProjectTreeFormatter.cpp` 重构**：`generate_sorted_output` 函数由递归改为循环实现。
* *路径*: `reports/shared/formatters/base/ProjectTreeFormatter.cpp`
* *逻辑*: 使用 `std::stack`（迭代法）替代深度优先搜索（DFS），将内存占用从栈转移至堆，规避栈溢出风险。


3. **代码复用**：`DayTyp.cpp` 正式复用 `ProjectTreeFormatter` 核心逻辑。
4. **数据结构优化**：`ProjectNode` 内部结构由 `std::map` 修改为 `std::unordered_map`。
* *原因*: 消除 `std::map` 自动排序带来的无效开销（程序后续会根据 `duration` 手动重排）。
* *性能*: 插入与查找的平均时间复杂度由  优化至 。


### 2. 核心组件重构 (Core Refactoring)

| 维度 | 说明 |
| --- | --- |
| **涉及文件** | `ProjectTreeFormatter.cpp` & `.hpp` |
| **消除递归** | 重写为基于 `std::stack` 的迭代算法，支持深层嵌套。 |
| **接口导出** | 添加 `REPORTS_SHARED_API` 宏，解决 DLL 链接时的 `undefined reference` 错误。 |

### 3. 格式化器代码复用 (Code Reuse)

所有格式化器均已复用 `ProjectTreeFormatter`，并通过**策略模式**实现差异化输出，不再依赖 `MarkdownUtils` 或 `TypUtils`。

#### A. 日报 (Daily Reports)

* **`DayTyp.cpp`**
* 移除 `TypUtils.hpp`。
* 内部定义 `TypstFormattingStrategy`。


* **`DayMd.cpp`**
* 移除 `MarkdownUtils.hpp`。
* 内部定义 `MarkdownFormattingStrategy`。



#### B. 月报 (Monthly Reports)

* **`MonthTyp.cpp`**
* 移除旧依赖，实现月报专用 Typst 策略。


* **`MonthMd.cpp`**
* 移除旧依赖，实现月报专用 Markdown 策略。



#### C. 周期报告 (Period Reports)

* **`PeriodTyp.cpp`**
* 移除旧依赖，实现周期报告专用 Typst 策略。


* **`PeriodMd.cpp`**
* 移除旧依赖，实现周期报告专用 Markdown 策略。


## 0.3.25.3 - 2025-12-27
### 优化日期检查命令
现在日期检查为可选--date-check <mode>
continuity：检查记录之间是否存在缺失的日期（检查间断性）。
full 或 strict：进行严格检查，确认该月份内的所有日期是否完整（检查完整性）。

默认都关闭

### run-pipeline新增选项控制
run-pipeline
支持 --date-check，默认关闭

### validate-source优化
现在validate-source支持传入单个json或文件夹(遍历文件夹寻找json)
如果没有传入指定路径，则去convert那一步生成的json路径去寻找

### main_cli中的打印cli用法，提取到cli模块
提取为CliHelp.cpp CliHelp.hpp


## 0.3.25.4 - 2025-12-27
### apps/time_matser改名为apps/time_tracer

apps/time_matser改名为apps/time_tracer

### 删除对于sleep_night的检测
reprocessing/validator/output_json/pipelines/BusinessRules.cpp
删除对于，当headers中sleep为1的时候，检查txt转化的json结构中当前日期第一条是否sleep_night

之前程序是把sleep_night放到了最后生成，不过之前修改了生成的地方，改为这一天的第一个活动
但是检验代码还没有修改，还是检验最后一个活动。

而且如果sleep_night没有正常生成，那肯定是json库相关代码出了问题，所以这个检查没什么意义
属于之前遗留的问题，可以删除了

所以，删除这段逻辑是最干净的做法。


### 删除时间连续性的检查
在validate-output中有对活动的时间是否连续的检查
但是时间连续性是由 ActivityMapper 的算法“强行”保证的
是由上一个的时间和当前的时间来生成，且ActivityMapper目前没有问题
所以等于白检测


### 修复interval_processor_config.json中的    "top_parent_mapping"
在 ActivityMapper.cpp 中已经编写了处理逻辑，但在 ConverterConfig.cpp 加载配置时，键名写错了

配置文件 (interval_processor_config.json)： 使用的是下划线命名法 "top_parent_mapping"。

代码 (reprocessing/converter/config/ConverterConfig.cpp)： 使用的是驼峰命名法 "topParentMapping"。


## 0.3.25.5 - 2026-01-01
1. reprocessing中的"generated_stats"中加入study总时间统计
数据库插入
reports中加入导出study
day报告所有格式加入
        {
            "label": "Study Time", 
            "db_column": "study_time",  
            "show": true
        },

2. time_master_cli 重命名为 cli
并且修改cmake中 time_master_cli相关 重命名为 cli

3. 加入tracer命令的彩蛋
为 run-pipeline 添加 blink 别名
输入tracer 打印 Cheers, love! The timetracer is here.
输入zen,motto 打印 Trace your time, log your life.

4. 拆分PipelineManager
拆分time_tracer/src/action_handler/file/PipelineManager



## 0.3.26.0 - 2026-01-06

### 核心架构重构 (Refactor)

* **路径管理升级**：核心组件全面采用 C++17 `std::filesystem::path` 替代 `std::string` 进行文件路径管理，以提供更强的类型安全性和跨平台兼容性。
* **AppConfig**：结构体中所有路径相关的成员变量（如 `exe_dir_path`, `*_config_path`, `export_path` 等）类型变更为 `fs::path`。
* **ConfigLoader**：内部路径处理及 `load_configuration()` 返回的配置对象已适配新的路径类型。
* **FileController**：文件控制器的路径成员及相关接口已更新，消除了路径字符串转换的开销。



### 共享模块与工具 (Shared & Utils)

* **ConfigUtils**：`load_json_config` 函数签名已更新，现在接受 `const std::filesystem::path&` 作为配置文件路径参数，利用 `std::ifstream` 对 `fs::path` 的原生支持。
* **接口一致性**：`reprocessing` 模块现与核心配置无缝对接，消除了隐式类型转换。

### 报表模块更新 (Reports)

* **日报 (Daily)**：
* `DayBaseConfig` 及其子类 (`DayMdConfig`, `DayTexConfig`, `DayTypConfig`) 构造函数已更新，接受 `fs::path` 类型的配置路径。

* **月报 (Monthly)**：
* `MonthBaseConfig` 及其子类 (`MonthMdConfig`, `MonthTexConfig`, `MonthTypConfig`) 构造函数已更新适配。

* **周期报告 (Period)**：
* `PeriodBaseConfig` 及其子类 (`PeriodMdConfig`, `PeriodTexConfig`, `PeriodTypConfig`) 构造函数已更新适配。

### 重要变更 (Breaking Changes)

* **ABI 兼容性破坏**：由于 `AppConfig` 结构体的内存布局发生变化（`std::string` 替换为 `std::filesystem::path`），**所有插件 DLL（日报、月报、周期报告的格式化器）必须重新编译**。旧版本的插件将无法加载或导致程序崩溃。
* **源代码兼容性**：大多数使用 `std::string` 进行路径拼接的代码仍可通过 `fs::path` 的 `/` 运算符兼容，但部分显式依赖 `std::string` 接口的调用可能需要调用 `.string()` 方法进行适配。
    
    



